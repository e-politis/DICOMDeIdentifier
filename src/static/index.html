<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta content="width=device-width, initial-scale=1" name="viewport">
        <title>DICOM de-identification and curation tool</title>
        <link href="data:," rel="icon">
    </head>

    <body>
        <nav>
            <a href="https://cordis.europa.eu/project/id/952179"><img alt="INCISIVE Cordis webpage" src="https://incisive-project.eu/wp-content/uploads/2021/01/incisive-header-logo.svg" height="20"></a> | <a href="https://github.com/pbizopoulos/dicom-de-identification-and-curation-tool">Source code (client side)</a> | <a href="https://github.com/fl0wxr/DICOMDeIdentifier">Source code (server side)</a>
        </nav>
        <h3>Input</h3>
        <form id="UploadForm" action="/upload_files/" enctype="multipart/form-data" method="post">
            <div>
                Load directory with DICOM files:
            </div>
            <input name="files" type="file" directory webkitdirectory mozdirectory>
            <div id="UploadStatus">
                </br>
                </br>
                Total uploaded files: 0
                </br>
                Size of uploaded content: 0 MB
                </br>
                </br>
            </div>
        </form>

        <form id="SessionForm" action="/upload_files/" enctype="application/json" method="post">
            Load session file:
            </br>
            <input name="file0" type="file">
            </br>
        </form>

        <h3>De-identification options</h3>

        <i>
            Based on
            <a href="https://dicom.nema.org/medical/dicom/current/output/chtml/part15/chapter_e.html"> DICOM PS3.15</a>
        </i>
        </br>
        Clean pixel data:
        <input type="checkbox" id="clean-image" checked>
        </br>
        Retain safe private:
        <input type="checkbox" id="retain-safe-private-input-checkbox" checked>
        </br>
        Retain UIDs:
        <input type="checkbox" id="retain-uids-input-checkbox" checked>
        </br>
        Retain device identity:
        <input type="checkbox" id="retain-device-identity-input-checkbox" checked>
        </br>
        Retain patient characteristics:
        <input type="checkbox" id="retain-patient-characteristics-input-checkbox" checked>
        </br>
        Date processing:
        <select id="date-processing-select">
            <option value="offset">Offset</option>
            <option value="remove">Remove</option>
            <option value="keep">Keep</option>
        </select>
        </br>
        Retain descriptors:
        <input type="checkbox" id="retain-descriptors-input-checkbox" checked>
        </br>
        Pseudo Patient ID prefix:
        <input type="text" id="patient-pseudo-id-prefix-input-text" placeholder="e.g. an organization ID">
        </br>
        </br>
        <button type="button" id="SubmitAnonymizationProcess" onclick="submit_dicom_processing_request()" disabled>
            De-Identify DICOM Files
        </button>
        </br>
        <h3>DICOM Conversion Result</h3>
        <div id="ControlPanel">
            <div id="DICOMBarWrap">
                <input id="DICOMBar" type="range" min="0" max="0" value="0" step="1" class="slider" id="DICOMRange" style="width: 500px;" oninput="updateValue(this.value)">
            </div>
            <div id="DICOMIDX">
                Index: -
                </br>
                Input Filename: -
                </br>
                Output Filename: -
            </div>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; grid-gap: 10px; padding: 10px;">
            <center>
                <div style="font-weight: bold;">Raw</div>
            </center>
            <center>
                <div style="font-weight: bold;">Clean</div>
            </center>
            <div style="border: 1px solid black; padding: 10px;">
                <img src="https://health.osu.edu/-/media/health/images/stories/2023/02/x-ray.jpg" alt="Image 1" style="width: 100%; height: auto; object-fit: cover;">
            </div>
            <div style="border: 1px solid black; padding: 10px;">
                <img src="https://health.osu.edu/-/media/health/images/stories/2023/02/x-ray.jpg" alt="Image 2" style="width: 100%; height: auto; object-fit: cover;">
            </div>
            <div style="border: 1px solid black; padding: 10px;">
                <table>
                    <tr>
                        <th>Tag ID</th>
                        <th>VR</th>
                        <th>Tag Name</th>
                        <th>Tag Value</th>
                    </tr>
                    <tr>
                        <td>(0008,0031)</td>
                        <td>TM</td>
                        <td>SeriesTime</td>
                        <td>040335.31000310003100031000310003100031000310</td>
                    </tr>
                    <tr>
                        <td>(0008,0031)</td>
                        <td>TM</td>
                        <td>SeriesTime</td>
                        <td>040335.31000</td>
                    </tr>
                    <tr>
                        <td>(0008,0031)</td>
                        <td>TM</td>
                        <td>SeriesTime</td>
                        <td>040335.31000</td>
                    </tr>
                    <tr>
                        <td>(0008,0031)</td>
                        <td>TM</td>
                        <td>SeriesTime</td>
                        <td>040335.31000</td>
                    </tr>
                </table>
            </div>
            <div style="border: 1px solid black; padding: 10px;">
                <table>
                    <tr>
                        <th>Tag ID</th>
                        <th>VR</th>
                        <th>Tag Name</th>
                        <th>Tag Value</th>
                    </tr>
                    <tr>
                        <td>040335.31000</td>
                        <td>040335.31000</td>
                        <td>040335.31000</td>
                        <td>040335.31000</td>
                    </tr>
                </table>
            </div>
        </div>

        <style>
            table {
                width: 100%;
                border-collapse: collapse;
            }
            th, td {
                text-align: center;
                padding: 10px;
                border: 1px solid rgb(209, 209, 209);
            }
        </style>
        <script src="/static/client.js"></script>
    </body>
</html>